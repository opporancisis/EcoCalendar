@(editForm: play.data.Form[models.event.Event],
	event: models.event.Event,
	grandEvents: List[models.event.GrandEvent],
	tags: List[models.event.tag.EventTag],
	organizations: List[models.organization.Organization])

@import helper._
@import scala.collection.mutable.LinkedHashMap

@main(
	if(editForm("id").value != null)
		"nav.event.edit"
	else
		"nav.event.create",
	leftNav = LinkedHashMap(
		"nav.event.list" -> routes.EventController.list
	),
	breadcrumbs = LinkedHashMap(
		"nav.event.list" -> routes.EventController.list,
		if (editForm("id").value != null) editForm("name").value -> routes.EventController.edit(editForm("id").value.toLong)
		else "nav.event.create" -> routes.EventController.create
	)
) {

	@helper.form(if(editForm("id").value != null) routes.EventController.doEdit(editForm("id").value.toLong) else routes.EventController.doCreate, 'class -> "form-horizontal") {

		@if(editForm.hasGlobalErrors) { 
			<div class="alert alert-danger">@editForm.globalError.message</div>
		}

		@if(event != null) {
			@_staticFormField("label.created", Formatters.print(event.created))
			@_staticFormField("label.updated", Formatters.print(event.updated))
			@_staticFormField("label.author", event.author.nick)
		}

		@inputText(
			field = editForm("name"),
			'_label -> "label.name"
		)(FieldConstructor(views.html.bootstrap.input.f), null)

		@bootstrap.selectB(
			field = editForm("parent"),
			optionMap = grandEvents.map(a => a.id + ":" + a.name -> {val p = editForm("parent").value; p != null && p.toLong == a.id}),
			isMultiple = false,
			label = "label.grand.event"
		)

		@textarea(
			field = editForm("description"),
			args = 'rows -> 3, 'cols -> 50,
			'_label -> "label.description"
		)(FieldConstructor(views.html.bootstrap.textarea.f), null)

		@inputText(
			field = editForm("additionalInfoLink"),
			'_label -> "label.link"
		)(FieldConstructor(views.html.bootstrap.input.f), null)

		@inputText(
			field = editForm("postReleaseLink"),
			'_label -> "label.link"
		)(FieldConstructor(views.html.bootstrap.input.f), null)

		@bootstrap.selectB(
			field = editForm("tags"),
			optionMap = tags.map(a => a.id + ":" + a.name -> {val t = editForm("tags").value; t != null && t.split(",").contains("" + a.id).booleanValue}),
			isMultiple = true,
			label = "label.tags"
		)

		@bootstrap.selectB(
			field = editForm("organizations"),
			optionMap = organizations.map(a => a.id + ":" + a.name -> {val t = editForm("organizations").value; t != null && t.split(",").contains("" + a.id).booleanValue}),
			isMultiple = true,
			label = "label.organizations"
		)

		<input type="submit" value="@{if(editForm("id").value != null) {Messages("label.save")} else {Messages("label.create")}}" class="btn btn-primary">

	}

	<div id='calendar'></div>

}