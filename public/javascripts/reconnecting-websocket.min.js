function ReconnectingWebSocket(e,n){function o(s){t=new WebSocket(e,n),c.onconnecting(),(c.debug||ReconnectingWebSocket.debugAll)&&console.debug("ReconnectingWebSocket","attempt-connect",e);var g=t,b=setTimeout(function(){(c.debug||ReconnectingWebSocket.debugAll)&&console.debug("ReconnectingWebSocket","connection-timeout",e),u=!0,g.close(),u=!1},c.timeoutInterval);t.onopen=function(n){clearTimeout(b),(c.debug||ReconnectingWebSocket.debugAll)&&console.debug("ReconnectingWebSocket","onopen",e),c.readyState=WebSocket.OPEN,s=!1,c.onopen(n)},t.onclose=function(n){clearTimeout(b),t=null,i?(c.readyState=WebSocket.CLOSED,c.onclose(n)):(c.readyState=WebSocket.CONNECTING,c.onconnecting(),s||u||((c.debug||ReconnectingWebSocket.debugAll)&&console.debug("ReconnectingWebSocket","onclose",e),c.onclose(n)),setTimeout(function(){o(!0)},c.reconnectInterval))},t.onmessage=function(n){(c.debug||ReconnectingWebSocket.debugAll)&&console.debug("ReconnectingWebSocket","onmessage",e,n.data),c.onmessage(n)},t.onerror=function(n){(c.debug||ReconnectingWebSocket.debugAll)&&console.debug("ReconnectingWebSocket","onerror",e,n),c.onerror(n)}}n=n||[],this.debug=!1,this.reconnectInterval=1e3,this.timeoutInterval=2e3;var t,c=this,i=!1,u=!1;this.url=e,this.protocols=n,this.readyState=WebSocket.CONNECTING,this.URL=e,this.onopen=function(){},this.onclose=function(){},this.onconnecting=function(){},this.onmessage=function(){},this.onerror=function(){},o(e),this.send=function(n){if(t)return(c.debug||ReconnectingWebSocket.debugAll)&&console.debug("ReconnectingWebSocket","send",e,n),t.send(n);throw"INVALID_STATE_ERR : Pausing to reconnect websocket"},this.close=function(){i=!0,t&&t.close()},this.refresh=function(){t&&t.close()}}ReconnectingWebSocket.debugAll=!1;